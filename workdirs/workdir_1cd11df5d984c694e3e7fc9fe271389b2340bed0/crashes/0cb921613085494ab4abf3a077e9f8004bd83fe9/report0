INFO: task kworker/0:9:3726 blocked for more than 143 seconds.
      Not tainted 5.18.0-syzkaller-13760-g032dcf09e2bf #0
"echo 0 > /proc/sys/kernel/hung_task_timeout_secs" disables this message.
task:kworker/0:9     state:D stack:23536 pid: 3726 ppid:     2 flags:0x00004000
Workqueue: usb_hub_wq hub_event
Call Trace:
 <TASK>
 context_switch root/ramdisk/work_dir/linux/kernel/sched/core.c:5116 [inline]
 __schedule+0xd07/0x4d90 root/ramdisk/work_dir/linux/kernel/sched/core.c:6428
 schedule+0xdb/0x200 root/ramdisk/work_dir/linux/kernel/sched/core.c:6500
 schedule_preempt_disabled+0xf/0x20 root/ramdisk/work_dir/linux/kernel/sched/core.c:6559
 __mutex_lock_common root/ramdisk/work_dir/linux/kernel/locking/mutex.c:679 [inline]
 __mutex_lock+0x910/0x12d0 root/ramdisk/work_dir/linux/kernel/locking/mutex.c:747
 add_early_randomness+0x1a/0x170 root/ramdisk/work_dir/linux/drivers/char/hw_random/core.c:69
 hwrng_register+0x36a/0x4f0 root/ramdisk/work_dir/linux/drivers/char/hw_random/core.c:599
 chaoskey_probe+0x76c/0xc40 root/ramdisk/work_dir/linux/drivers/usb/misc/chaoskey.c:205
 usb_probe_interface+0x30d/0x7d0 root/ramdisk/work_dir/linux/drivers/usb/core/driver.c:396
 call_driver_probe root/ramdisk/work_dir/linux/drivers/base/dd.c:555 [inline]
 really_probe+0x22a/0xb80 root/ramdisk/work_dir/linux/drivers/base/dd.c:634
 __driver_probe_device+0x337/0x4d0 root/ramdisk/work_dir/linux/drivers/base/dd.c:764
 driver_probe_device+0x4c/0x1a0 root/ramdisk/work_dir/linux/drivers/base/dd.c:794
 __device_attach_driver+0x202/0x2f0 root/ramdisk/work_dir/linux/drivers/base/dd.c:917
 bus_for_each_drv+0x155/0x1d0 root/ramdisk/work_dir/linux/drivers/base/bus.c:427
 __device_attach+0x1e8/0x530 root/ramdisk/work_dir/linux/drivers/base/dd.c:989
 bus_probe_device+0x1e4/0x290 root/ramdisk/work_dir/linux/drivers/base/bus.c:487
 device_add+0xcb6/0x2150 root/ramdisk/work_dir/linux/drivers/base/core.c:3417
 usb_set_configuration+0xf91/0x19b0 root/ramdisk/work_dir/linux/drivers/usb/core/message.c:2170
 usb_generic_driver_probe+0xb4/0xf0 root/ramdisk/work_dir/linux/drivers/usb/core/generic.c:238
 usb_probe_device+0xdb/0x2c0 root/ramdisk/work_dir/linux/drivers/usb/core/driver.c:293
 call_driver_probe root/ramdisk/work_dir/linux/drivers/base/dd.c:555 [inline]
 really_probe+0x22a/0xb80 root/ramdisk/work_dir/linux/drivers/base/dd.c:634
 __driver_probe_device+0x337/0x4d0 root/ramdisk/work_dir/linux/drivers/base/dd.c:764
 driver_probe_device+0x4c/0x1a0 root/ramdisk/work_dir/linux/drivers/base/dd.c:794
 __device_attach_driver+0x202/0x2f0 root/ramdisk/work_dir/linux/drivers/base/dd.c:917
 bus_for_each_drv+0x155/0x1d0 root/ramdisk/work_dir/linux/drivers/base/bus.c:427
 __device_attach+0x1e8/0x530 root/ramdisk/work_dir/linux/drivers/base/dd.c:989
 bus_probe_device+0x1e4/0x290 root/ramdisk/work_dir/linux/drivers/base/bus.c:487
 device_add+0xcb6/0x2150 root/ramdisk/work_dir/linux/drivers/base/core.c:3417
 usb_new_device.cold+0x660/0x10e5 root/ramdisk/work_dir/linux/drivers/usb/core/hub.c:2566
 hub_port_connect root/ramdisk/work_dir/linux/drivers/usb/core/hub.c:5363 [inline]
 hub_port_connect_change root/ramdisk/work_dir/linux/drivers/usb/core/hub.c:5507 [inline]
 port_event root/ramdisk/work_dir/linux/drivers/usb/core/hub.c:5663 [inline]
 hub_event+0x219d/0x4bb0 root/ramdisk/work_dir/linux/drivers/usb/core/hub.c:5745
 process_one_work+0x9f5/0x1630 root/ramdisk/work_dir/linux/kernel/workqueue.c:2289
 worker_thread+0x679/0x10d0 root/ramdisk/work_dir/linux/kernel/workqueue.c:2436
 kthread+0x2e0/0x390 root/ramdisk/work_dir/linux/kernel/kthread.c:376
 ret_from_fork+0x1f/0x30 root/ramdisk/work_dir/linux/arch/x86/entry/entry_64.S:302
 </TASK>

Showing all locks held in the system:
3 locks held by kworker/u4:1/12:
1 lock held by pr/ttyS0/18:
1 lock held by khungtaskd/32:
 #0: ffffffff8bd87820 (rcu_read_lock){....}-{1:2}, at: debug_show_all_locks+0x53/0x260 root/ramdisk/work_dir/linux/kernel/locking/lockdep.c:6491
1 lock held by hwrng/748:
 #0: ffffffff8c836b28 (reading_mutex){+.+.}-{3:3}, at: hwrng_fillfn+0x141/0x370 root/ramdisk/work_dir/linux/drivers/char/hw_random/core.c:503
1 lock held by udevd/3001:
2 locks held by getty/3294:
 #0: ffff88801f4bb098 (&tty->ldisc_sem){++++}-{0:0}, at: tty_ldisc_ref_wait+0x20/0x80 root/ramdisk/work_dir/linux/drivers/tty/tty_ldisc.c:244
 #1: ffffc90000d802e8 (&ldata->atomic_read_lock){+.+.}-{3:3}, at: n_tty_read+0xeaf/0x1430 root/ramdisk/work_dir/linux/drivers/tty/n_tty.c:2124
3 locks held by udevd/3625:
 #0: ffff888067e5bc88 (&of->mutex){+.+.}-{3:3}, at: kernfs_file_read_iter root/ramdisk/work_dir/linux/fs/kernfs/file.c:197 [inline]
 #0: ffff888067e5bc88 (&of->mutex){+.+.}-{3:3}, at: kernfs_fop_read_iter+0x181/0x6c0 root/ramdisk/work_dir/linux/fs/kernfs/file.c:236
 #1: ffff8880655b70f0 (kn->active#88){++++}-{0:0}, at: kernfs_file_read_iter root/ramdisk/work_dir/linux/fs/kernfs/file.c:198 [inline]
 #1: ffff8880655b70f0 (kn->active#88){++++}-{0:0}, at: kernfs_fop_read_iter+0x1a4/0x6c0 root/ramdisk/work_dir/linux/fs/kernfs/file.c:236
 #2: ffff888043afe190 (&dev->mutex){....}-{3:3}, at: device_lock_interruptible root/ramdisk/work_dir/linux/./include/linux/device.h:840 [inline]
 #2: ffff888043afe190 (&dev->mutex){....}-{3:3}, at: read_descriptors+0x3c/0x2c0 root/ramdisk/work_dir/linux/drivers/usb/core/sysfs.c:873
6 locks held by kworker/0:9/3726:
 #0: ffff888014011138 ((wq_completion)usb_hub_wq){+.+.}-{0:0}, at: arch_atomic64_set root/ramdisk/work_dir/linux/./arch/x86/include/asm/atomic64_64.h:34 [inline]
 #0: ffff888014011138 ((wq_completion)usb_hub_wq){+.+.}-{0:0}, at: arch_atomic_long_set root/ramdisk/work_dir/linux/./include/linux/atomic/atomic-long.h:41 [inline]
 #0: ffff888014011138 ((wq_completion)usb_hub_wq){+.+.}-{0:0}, at: atomic_long_set root/ramdisk/work_dir/linux/./include/linux/atomic/atomic-instrumented.h:1280 [inline]
 #0: ffff888014011138 ((wq_completion)usb_hub_wq){+.+.}-{0:0}, at: set_work_data root/ramdisk/work_dir/linux/kernel/workqueue.c:636 [inline]
 #0: ffff888014011138 ((wq_completion)usb_hub_wq){+.+.}-{0:0}, at: set_work_pool_and_clear_pending root/ramdisk/work_dir/linux/kernel/workqueue.c:663 [inline]
 #0: ffff888014011138 ((wq_completion)usb_hub_wq){+.+.}-{0:0}, at: process_one_work+0x8d9/0x1630 root/ramdisk/work_dir/linux/kernel/workqueue.c:2260
 #1: ffffc90003f27da0 ((work_completion)(&hub->events)){+.+.}-{0:0}, at: process_one_work+0x90d/0x1630 root/ramdisk/work_dir/linux/kernel/workqueue.c:2264
 #2: ffff8880424b6190 (&dev->mutex){....}-{3:3}, at: device_lock root/ramdisk/work_dir/linux/./include/linux/device.h:835 [inline]
 #2: ffff8880424b6190 (&dev->mutex){....}-{3:3}, at: hub_event+0x1a7/0x4bb0 root/ramdisk/work_dir/linux/drivers/usb/core/hub.c:5691
 #3: ffff888043afe190 (&dev->mutex){....}-{3:3}, at: device_lock root/ramdisk/work_dir/linux/./include/linux/device.h:835 [inline]
 #3: ffff888043afe190 (&dev->mutex){....}-{3:3}, at: __device_attach+0x7f/0x530 root/ramdisk/work_dir/linux/drivers/base/dd.c:964
 #4: ffff888019998118 (&dev->mutex){....}-{3:3}, at: device_lock root/ramdisk/work_dir/linux/./include/linux/device.h:835 [inline]
 #4: ffff888019998118 (&dev->mutex){....}-{3:3}, at: __device_attach+0x7f/0x530 root/ramdisk/work_dir/linux/drivers/base/dd.c:964
 #5: ffffffff8c836b28 (reading_mutex){+.+.}-{3:3}, at: add_early_randomness+0x1a/0x170 root/ramdisk/work_dir/linux/drivers/char/hw_random/core.c:69
1 lock held by syz-executor.0/19419:
1 lock held by syz-executor.2/19418:
2 locks held by syz-executor.6/19416:
2 locks held by syz-executor.5/19420:

=============================================

NMI backtrace for cpu 0
CPU: 0 PID: 32 Comm: khungtaskd Not tainted 5.18.0-syzkaller-13760-g032dcf09e2bf #0
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.16.2-debian-1.16.2-1 04/01/2014
Call Trace:
 <TASK>
 __dump_stack root/ramdisk/work_dir/linux/lib/dump_stack.c:88 [inline]
 dump_stack_lvl+0xfc/0x174 root/ramdisk/work_dir/linux/lib/dump_stack.c:106
 nmi_cpu_backtrace.cold+0x22/0x16f root/ramdisk/work_dir/linux/lib/nmi_backtrace.c:111
 nmi_trigger_cpumask_backtrace+0x1ea/0x230 root/ramdisk/work_dir/linux/lib/nmi_backtrace.c:62
 trigger_all_cpu_backtrace root/ramdisk/work_dir/linux/./include/linux/nmi.h:146 [inline]
 check_hung_uninterruptible_tasks root/ramdisk/work_dir/linux/kernel/hung_task.c:220 [inline]
 watchdog+0xcdf/0x1070 root/ramdisk/work_dir/linux/kernel/hung_task.c:378
 kthread+0x2e0/0x390 root/ramdisk/work_dir/linux/kernel/kthread.c:376
 ret_from_fork+0x1f/0x30 root/ramdisk/work_dir/linux/arch/x86/entry/entry_64.S:302
 </TASK>
Sending NMI from CPU 0 to CPUs 1:
NMI backtrace for cpu 1
CPU: 1 PID: 3001 Comm: udevd Not tainted 5.18.0-syzkaller-13760-g032dcf09e2bf #0
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.16.2-debian-1.16.2-1 04/01/2014
RIP: 0010:orc_find root/ramdisk/work_dir/linux/arch/x86/kernel/unwind_orc.c:164 [inline]
RIP: 0010:unwind_next_frame+0x215/0x1c10 root/ramdisk/work_dir/linux/arch/x86/kernel/unwind_orc.c:443
Code: 7c 24 20 e8 4d 67 92 00 48 8b 4c 24 30 8b 44 24 28 8b 74 24 20 41 83 c7 01 8b 0c 8d f4 cf d6 8e 48 ba 00 00 00 00 00 fc ff df <4a> 8d 3c bd f4 cf d6 8e 49 89 f8 49 c1 e8 03 45 0f b6 04 10 48 89
RSP: 0018:ffffc900021df320 EFLAGS: 00000206
RAX: 000000000008a07a RBX: 0000000000000001 RCX: 000000000002d630
RDX: dffffc0000000000 RSI: 000000000000c72a RDI: ffffffff8ed9ec9c
RBP: ffffc900021df3d8 R08: 0000000000000000 R09: 0000000000000005
R10: fffff5200043be7d R11: 0000000000000000 R12: ffffc900021df3c5
R13: ffffc900021df390 R14: ffffffff81c72afd R15: 000000000000c72b
FS:  00007fcadd10f280(0000) GS:ffff88807ec00000(0000) knlGS:0000000000000000
CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
CR2: 00007fc0a7054d58 CR3: 0000000043b45000 CR4: 0000000000350ee0
DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
Call Trace:
 <TASK>
 arch_stack_walk+0x7d/0xe0 root/ramdisk/work_dir/linux/arch/x86/kernel/stacktrace.c:25
 stack_trace_save+0x92/0xc0 root/ramdisk/work_dir/linux/kernel/stacktrace.c:122
 kasan_save_stack+0x1c/0x40 root/ramdisk/work_dir/linux/mm/kasan/common.c:38
 kasan_set_track+0x21/0x30 root/ramdisk/work_dir/linux/mm/kasan/common.c:45
 kasan_set_free_info+0x20/0x30 root/ramdisk/work_dir/linux/mm/kasan/generic.c:370
 ____kasan_slab_free root/ramdisk/work_dir/linux/mm/kasan/common.c:366 [inline]
 ____kasan_slab_free+0x125/0x1a0 root/ramdisk/work_dir/linux/mm/kasan/common.c:328
 kasan_slab_free root/ramdisk/work_dir/linux/./include/linux/kasan.h:200 [inline]
 slab_free_hook root/ramdisk/work_dir/linux/mm/slub.c:1727 [inline]
 slab_free_freelist_hook+0xae/0x1e0 root/ramdisk/work_dir/linux/mm/slub.c:1753
 slab_free root/ramdisk/work_dir/linux/mm/slub.c:3507 [inline]
 kfree+0xd6/0x4c0 root/ramdisk/work_dir/linux/mm/slub.c:4555
 tomoyo_check_open_permission+0x16b/0x370 root/ramdisk/work_dir/linux/security/tomoyo/file.c:786
 tomoyo_file_open root/ramdisk/work_dir/linux/security/tomoyo/tomoyo.c:320 [inline]
 tomoyo_file_open+0x9b/0xc0 root/ramdisk/work_dir/linux/security/tomoyo/tomoyo.c:315
 security_file_open+0x66/0xe0 root/ramdisk/work_dir/linux/security/security.c:1645
 do_dentry_open+0x4ca/0x1190 root/ramdisk/work_dir/linux/fs/open.c:835
 do_open root/ramdisk/work_dir/linux/fs/namei.c:3527 [inline]
 path_openat+0xd4b/0x2b80 root/ramdisk/work_dir/linux/fs/namei.c:3660
 do_filp_open+0x1bf/0x420 root/ramdisk/work_dir/linux/fs/namei.c:3687
 do_sys_openat2+0x16b/0x4c0 root/ramdisk/work_dir/linux/fs/open.c:1278
 do_sys_open root/ramdisk/work_dir/linux/fs/open.c:1294 [inline]
 __do_sys_openat root/ramdisk/work_dir/linux/fs/open.c:1310 [inline]
 __se_sys_openat root/ramdisk/work_dir/linux/fs/open.c:1305 [inline]
 __x64_sys_openat+0x171/0x210 root/ramdisk/work_dir/linux/fs/open.c:1305
 do_syscall_x64 root/ramdisk/work_dir/linux/arch/x86/entry/common.c:50 [inline]
 do_syscall_64+0x34/0xb0 root/ramdisk/work_dir/linux/arch/x86/entry/common.c:80
 entry_SYSCALL_64_after_hwframe+0x46/0xb0
RIP: 0033:0x7fcadcd1a477
Code: 10 00 00 00 44 8b 54 24 e0 48 89 44 24 c0 48 8d 44 24 d0 48 89 44 24 c8 44 89 c2 4c 89 ce bf 9c ff ff ff b8 01 01 00 00 0f 05 <48> 3d 00 f0 ff ff 76 10 48 8b 15 82 69 0d 00 f7 d8 64 89 02 48 83
RSP: 002b:00007fffe7b45338 EFLAGS: 00000287 ORIG_RAX: 0000000000000101
RAX: ffffffffffffffda RBX: 000055e540787f10 RCX: 00007fcadcd1a477
RDX: 0000000000090800 RSI: 000055e540775780 RDI: 00000000ffffff9c
RBP: 000055e540809630 R08: 0000000000090800 R09: 000055e540775780
R10: 0000000000000000 R11: 0000000000000287 R12: 000055e540775780
R13: 00000000000000ff R14: 000055e53e9ef1c4 R15: 0000000000000000
 </TASK>
